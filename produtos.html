<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
   <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css"/> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- usando normalize css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
        integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&family=Roboto:wght@100;300;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="assets/css/global.css">
    <link rel="shortcut icon" href="assets/imagens/fav/favicon-16x16.png" type="image/x-icon">


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.js"
        integrity="sha512-6DC1eE3AWg1bgitkoaRM1lhY98PxbMIbhgYCGV107aZlyzzvaWCW1nJW2vDuYQm06hXrW0As6OGKcIaAVWnHJw=="
        crossorigin="anonymous" referrerpolicy="no-referrer">
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>Tobacco | Produtos</title>
    <script>
        $(document).ready(function () {
            $(window).bind('scroll', function () {
                let gap = 50

                if ($(window).scrollTop() > gap) {
                    $('header').addClass('active')
                } else {
                    $('header').removeClass('active')
                }
            })
        })


        function getProd() {
            $.ajax({
                url: "get_prod.php",
                success: function (data) {
                    const prod = JSON.parse(data);
                    console.log(prod); 
                    
                    for (let index = 0; index < prod.length; index++) {                        
                        $('#superior').append(`
                        <card-product image="${prod[index].img_prod}"
                            photo="${prod[index].capa_prod}" title="${prod[index].desc_prod}" price="R$ ${prod[index].preco_prod}"
                            id="${prod[index].cod_prod}"
                            onclick="addCart(this.id)">
                        </card-product>
                        `);
                    }                    
                }
            });
        }

        function userLogged() {
            $.ajax({
                type: "GET",
                url: "quem.php",
                success: function(resposta){
                    if(!resposta){
                        $("#user").html("Fa√ßa Login.");
                    }else{
                        $("#user").html("Bem vindo "+resposta);
                    }
                }
            })
        }

        function addCart(id) {            
            $.ajax({
                type: "POST",
                url: `addCart.php`,
                data: {
                    id_prod: `${id}`
                },
                success: function(resposta){
                    alert(resposta);
                    getCart("prod_qtd");                    
                }
            })            
        }

        function getCart(id){
            $.ajax({
                url: "getCart.php",
                success: function(resposta){

                    if (resposta <= 0) {
                        document.getElementById(id).innerHTML="";  
                        document.getElementById(id).className = "";
                    }else{
                        document.getElementById(id).innerHTML=resposta;
                        document.getElementById(id).className = "cart-value";
                    }
                }
            });
        }
        
    </script>
</head>

<body onload="getProd(), getCart('prod_qtd'), userLogged()">
    <header>
        <div class="container">
            <div class="toggle-btn" onclick="dropdownFunc();">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="logo">
                <img src="assets/imagens/TobaccoRebrand.png">
            </div>
            <nav class="nav" id="nav">
                <ul class="nav-links">
                    <li><a href="index.html">HOME</a></li>
                    <!-- <li><a href="produtos.html">PRODUTOS</a></li>
                    <li><a href="#contato">CONTATO</a></li>
                    <li><a href="#sobre">SOBRE</a></li> -->
                </ul>
                <ul class="icons-nav">
                    <div class="user" id="user">
                        Bem vindo.
                    </div>
                    <a href="login.html"><li><ion-icon name="person-outline" size="large"></ion-icon></li></a>
                    <li>
                        <div class="cart-container">
                            <div class="cart-item">
                                <a href="carrinho.html"><ion-icon name="cart-outline" size="large"></ion-icon></a>
                            </div>
                            <div class="" id="prod_qtd"></div>
                        </div>
                        
                    </li>
                </ul>
            </nav>

        </div>
    </header>
    <section id="content1" class="content1">
        <div class="bg-image">
            <img src="assets/imagens/COVERPROD3.png" width="100%" height="100%">

            <!-- <div class="text-smok"><h2>VENHA NOS VISITAR OU ENTRE EM CONTATO:</h2><br> -->
            <!-- <center><h3><a href="#contato" class="link-contato">CONTATO</a></h3></center>
                <main class="destaque-prod"></main> -->
        </div>
    </section>
    <main class="products" id="superior">
        <!-- <card-product image="assets/imagens/products/behike/behike01.webp"
            photo="assets/imagens/products/behike/behike03.webp" title="Behike" price="R$ 250"
            id="01"
            onclick="teste(this.id)">
        </card-product> -->
    </main>
    <main class="products" id="centro-superior">
        <card-product></card-product>
        <card-product></card-product>

    </main>
    <main class="products" id="inferior">
        <card-product></card-product>
        <card-product></card-product>
        <card-product></card-product>
        <card-product></card-product>

    </main>
    <main class="products" id="centro-inferior">
        <card-product></card-product>
        <card-product></card-product>

    </main>
    <main class="products" id="footer">
        <card-product></card-product>
        <card-product></card-product>
        <card-product></card-product>
        <card-product></card-product>

    </main>


    <footer>
        <div class="footer">
            <img src="assets/imagens/TOBACCO.png" alt="">
            <!-- <ul class="lista-footer">
                <li>Termos</li>
                <li>Sociais</li>
            </ul> -->
        </div>
    </footer>


    <script src="assets/src/components/CardProduct.js"></script>
    <script src="assets/src/dropdownFunc.js"></script>
    <!-- Materialize -->
    <!-- <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script> -->

    <!-- ionic -->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</body>

</html>